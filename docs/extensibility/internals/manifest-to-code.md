---
title: Manifest to Code | Microsoft Docs
description: Découvrez comment utiliser le manifeste à partir de l’outil de code qui utilise un fichier. imagemanifest pour l’utiliser avec le service d’images Visual Studio.
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
ms.assetid: 17ecacea-397d-4a97-b003-01bd5d56e936
author: acangialosi
ms.author: anthc
manager: jmartens
ms.workload:
- vssdk
ms.openlocfilehash: 709867c44456223da129460eb6ea72c413ba5b48
ms.sourcegitcommit: ae6d47b09a439cd0e13180f5e89510e3e347fd47
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 02/08/2021
ms.locfileid: "99839413"
---
# <a name="manifest-to-code"></a>Manifest to Code
L’outil Manifest to Code est une application console qui accepte un fichier. imagemanifest pour le service d’images Visual Studio et génère un ou des fichiers de wrapper pour référencer les valeurs du manifeste d’image dans les fichiers C++, C#, VB ou. vsct pour les extensions Visual Studio. Cet outil génère des fichiers wrapper qui peuvent être utilisés pour demander directement des images du service d’images Visual Studio, ou pour transmettre les valeurs de manifeste via des API si le code ne gère pas sa propre interface utilisateur et son propre rendu.

## <a name="how-to-use-the-tool"></a>Comment utiliser l’outil
 **Syntaxe**

 ManifestToCode/manifest : \<Image Manifest file> /Language : \<Code Language>\<Optional Args>

 **Arguments**

|**Nom du commutateur**|**Remarques**|**Obligatoire ou facultatif**|
|-|-|-|
|/manifest|Chemin d’accès au manifeste d’image à utiliser pour créer ou mettre à jour le wrapper de code.|Obligatoire|
|/Language|Langage dans lequel le wrapper de code doit être généré.<br /><br /> Valeurs valides : CPP, C++, CS, CSharp, C#, VB ou VSCT les valeurs ne respectent pas la casse.<br /><br /> Pour l’option de langue VSCT, les options/monikerClass,/classAccess et/namespace sont ignorées.|Obligatoire|
|/imageIdClass|Nom du imageIdClass et du fichier associé créé par l’outil. Pour l’option de langage C++, seuls les fichiers. h sont générés.<br /><br /> Valeur par défaut : \<Manifest Path> \MyImageIds.\<Lang Ext>|Facultatif|
|/monikerClass|Nom du monikerClass et du fichier associé créé par l’outil. Pour l’option de langage C++, seuls les fichiers. h sont générés. Cela est ignoré pour le langage VSCT.<br /><br /> Valeur par défaut : \<Manifest Path> \MyMonikers.\<Lang Ext>|Facultatif|
|/classAccess|Modificateur d’accès pour imageIdClass et monikerClass. Assurez-vous que le modificateur d’accès est valide pour la langue donnée. Cette option est ignorée pour l’option de langue VSCT.<br /><br /> Valeur par défaut : public|Facultatif|
|/namespace|Espace de noms défini dans le wrapper de code. Cette option est ignorée pour l’option de langue VSCT. '. 'Ou' :: 'sont des séparateurs d’espace de noms valides, quelle que soit l’option de langage choisie.<br /><br /> Valeur par défaut : MyImages|Facultatif|
|/noLogo|La définition de cet indicateur arrête l’impression du produit et des informations de copyright.|Facultatif|
|/?|Imprimer les informations d’aide.|Facultatif|
|/help|Imprimer les informations d’aide.|Facultatif|

 **Exemples**

- ManifestToCode/manifest : D:\MyManifest.imagemanifest/Language : CSharp

- ManifestToCode/manifest : D:\MyManifest.imagemanifest/Language : C++/Namespace : My :: namespace/imageIdClass : MyImageIds/monikerClass : MyMonikers/classAccess : Friend

- ManifestToCode/manifest : D:\MyManifest.imagemanifest/Language : VSCT/imageIdClass : MyImageIds

## <a name="notes"></a>Notes

- Nous vous recommandons d’utiliser cet outil avec les manifestes d’image générés par l’outil Manifest from Resources.

- L’outil examine uniquement les entrées de symboles pour générer les wrappers de code. Si un manifeste d’image ne contient aucun symbole, les wrappers de code générés sont vides. Si le manifeste de l’image contient une image ou un ensemble d’images qui n’utilisent pas de symboles, elles sont exclues du wrapper de code.

## <a name="sample-output"></a>Exemple de sortie
 **Wrappers C#**

 Une paire d’ID d’image simple et de classes de moniker d’image pour C# sera semblable au code ci-dessous :

```csharp
//-----------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the ManifestToCode tool.
//     Tool Version: 14.0.15198
// </auto-generated>
//-----------------------------------------------------------------------------

using System;

namespace MyImages
{
    public static class MyImageIds
    {
        public static readonly Guid AssetsGuid = new Guid("{442d8739-efde-46a4-8f29-e3a1e5e7f8b4}");

        public const int MyImage1 = 0;
        public const int MyImage2 = 1;
    }
}
//-----------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the ManifestToCode tool.
//     Tool Version: 14.0.15198
// </auto-generated>
//-----------------------------------------------------------------------------

using Microsoft.VisualStudio.Imaging.Interop;

namespace MyImages
{
    public static class MyMonikers
    {
        public static ImageMoniker MyImage1 { get { return new ImageMoniker { Guid = MyImageIds.AssetsGuid, Id = MyImageIds.MyImage1 }; } }
        public static ImageMoniker MyImage2 { get { return new ImageMoniker { Guid = MyImageIds.AssetsGuid, Id = MyImageIds.MyImage2 }; } }
    }
}
```

 **Wrappers C++**

 Une paire d’ID d’image simple et de classes de moniker d’image pour C++ sera semblable au code ci-dessous :

```cpp
//-----------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the ManifestToCode tool.
//     Tool Version: 14.0.15198
// </auto-generated>
//-----------------------------------------------------------------------------

#pragma once

#include <guiddef.h>

namespace MyImages {

class MyImageIds {
public:

    static const GUID AssetsGuid;

    static const int MyImage1 = 0;
    static const int MyImage2 = 1;

};

__declspec(selectany) const GUID MyImageIds::AssetsGuid = {0x442d8739,0xefde,0x46a4,{0x8f,0x29,0xe3,0xa1,0xe5,0xe7,0xf8,0xb4}};

}
//-----------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the ManifestToCode tool.
//     Tool Version: 14.0.15198
// </auto-generated>
//-----------------------------------------------------------------------------

#pragma once

#include "ImageParameters140.h"
#include "MyImageIds.h"

namespace MyImages {

class MyMonikers {
public:

    static const ImageMoniker MyImage1;
    static const ImageMoniker MyImage2;

};

__declspec(selectany) const ImageMoniker MyMonikers::MyImage1 = { MyImageIds::AssetsGuid, MyImageIds::MyImage1 };
__declspec(selectany) const ImageMoniker MyMonikers::MyImage2 = { MyImageIds::AssetsGuid, MyImageIds::MyImage2 };

}
```

 **Wrappers de Visual Basic**

 Une paire d’ID d’image simple et de classes de moniker d’image pour Visual Basic est semblable au code ci-dessous :

```vb
' -----------------------------------------------------------------------------
'  <auto-generated>
'      This code was generated by the ManifestToCode tool.
'      Tool Version: 14.0.15198
'  </auto-generated>
' -----------------------------------------------------------------------------

Imports System

Namespace MyImages

    Public Module MyImageIds

        Public Shared ReadOnly AssetsGuid As Guid = New Guid("{442d8739-efde-46a4-8f29-e3a1e5e7f8b4}")

        Public Const MyImage1 As Integer = 0
        Public Const MyImage2 As Integer = 1

    End Module

End Namespace
' -----------------------------------------------------------------------------
'  <auto-generated>
'      This code was generated by the ManifestToCode tool.
'      Tool Version: 14.0.15198
'  </auto-generated>
' -----------------------------------------------------------------------------

Imports Microsoft.VisualStudio.Imaging.Interop

Namespace MyImages

    Public Module MyMonikers

        Public Readonly Property MyImage1
            Get
                Return New ImageMoniker With {.Guid = MyImageIds.AssetsGuid, .Id = MyImageIds.MyImage1}
            End Get
        End Property

        Public Readonly Property MyImage2
            Get
                Return New ImageMoniker With {.Guid = MyImageIds.AssetsGuid, .Id = MyImageIds.MyImage2}
            End Get
        End Property

    End Module

End Namespace
```

 **Wrapper VSCT**

 Un ensemble d’ID d’image pour un fichier. vsct est similaire à ce qui suit :

```xml
<?xml version='1.0' encoding='utf-8'?>
<!--
- [auto-generated]
     This code was generated by the ManifestToCode tool.
     Tool Version: 14.0.15198
- [/auto-generated]
-->
<CommandTable xmlns="http://schemas.microsoft.com/VisualStudio/2005-10-18/CommandTable">
  <Symbols>
    <GuidSymbol name="AssetsGuid" value="{442d8739-efde-46a4-8f29-e3a1e5e7f8b4}">
      <IDSymbol name="MyImage1" value="0" />
      <IDSymbol name="MyImage2" value="1" />
    </GuidSymbol>
  </Symbols>
</CommandTable>
```
